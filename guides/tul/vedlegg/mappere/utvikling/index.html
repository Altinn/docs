<!DOCTYPE html>
<html lang="nb" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.30.2">
    <meta name="description" content="Beskrivelse av hvordan man utvikler">
    <title>
      Utvikling :: Altinn docs
    </title>
    <link rel="shortcut icon" href="/docs/images/favicon.png" type="image/x-icon">
    <link href="/docs/css/nucleus.css" rel="stylesheet">
    <link href="/docs/css/font-awesome.min.css" rel="stylesheet">
    <link href="/docs/css/hybrid.css" rel="stylesheet">
    <link href="/docs/css/featherlight.min.css" rel="stylesheet">
    <link href="/docs/css/horsey.css" rel="stylesheet">
    <link href="/docs/css/theme.css" rel="stylesheet">
    <link rel="stylesheet" href="/docs/css/bootstrap.min.css">
    <script src="/docs/js/jquery-2.x.min.js"></script>
    <style type="text/css">
      :root #header + #content > #left > #rlblock_left {
        display:none !important;
      }
    </style>
    <link href="/docs/css/altinn.css" rel="stylesheet">
  </head>
  <body class="" data-url="/docs/guides/tul/vedlegg/mappere/utvikling/">
    <nav id="sidebar" class="">
      <div class="highlightable">
        <div id="header-wrapper">
          <div id="header">
            <p>
              <a href="/docs" title="Altinn docs"><img src="/docs/images/a-logo-white.svg" alt="Altinn"> docs</a>
            </p>
          </div>

          <div class="searchbox">
            <label for="search-by"><i class="fa fa-search"></i></label> <input data-search-input="" id="search-by" type="text" placeholder="Søk..."> <span data-search-clear=""><i class="fa fa-close"></i></span>
          </div>
          <script type="text/javascript" src="/docs/js/lunr.min.js"></script> 
          <script type="text/javascript" src="/docs/js/horsey.js"></script> 
          <script type="text/javascript">

          var baseurl = "https:\/\/altinn.github.io\/docs\/";
          </script> 
          <script type="text/javascript" src="/docs/js/search.js"></script>
        </div>

        <ul class="topics">
          <li data-nav-id="/docs/guides/" class="dd-item parent">
            <a href="/docs/guides/"><span>Guider</span> <i class="fa fa-angle-down fa-lg category-icon"></i></a>
            <ul>
              <li data-nav-id="/docs/guides/integrasjon/" class="dd-item">
                <a href="/docs/guides/integrasjon/"><span>Integrasjon</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                <ul>
                  <li data-nav-id="/docs/guides/integrasjon/generelt/" class="dd-item">
                    <a href="/docs/guides/integrasjon/generelt/"><span>Generelt</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                    <ul>
                      <li data-nav-id="/docs/guides/integrasjon/generelt/overordnet/" class="dd-item">
                        <a href="/docs/guides/integrasjon/generelt/overordnet/"><span>Overordnet</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/integrasjon/generelt/api-key/" class="dd-item">
                        <a href="/docs/guides/integrasjon/generelt/api-key/"><span>API-key</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/integrasjon/generelt/feil-og-mangler/" class="dd-item">
                        <a href="/docs/guides/integrasjon/generelt/feil-og-mangler/"><span>Kjente feil og mangler</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/integrasjon/generelt/retningslinjer/" class="dd-item">
                        <a href="/docs/guides/integrasjon/generelt/retningslinjer/"><span>Retningslinjer</span></a>
                      </li>
                    </ul>
                  </li>

                  <li data-nav-id="/docs/guides/integrasjon/tjenesteeiere/" class="dd-item">
                    <a href="/docs/guides/integrasjon/tjenesteeiere/"><span>Tjenesteeiere</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                    <ul>
                      <li data-nav-id="/docs/guides/integrasjon/tjenesteeiere/innledning/" class="dd-item">
                        <a href="/docs/guides/integrasjon/tjenesteeiere/innledning/"><span>Innledning</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/integrasjon/tjenesteeiere/api/" class="dd-item">
                        <a href="/docs/guides/integrasjon/tjenesteeiere/api/"><span>REST API</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                        <ul>
                          <li data-nav-id="/docs/guides/integrasjon/tjenesteeiere/api/registrering/" class="dd-item">
                            <a href="/docs/guides/integrasjon/tjenesteeiere/api/registrering/"><span>Registrering</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/integrasjon/tjenesteeiere/api/autorisasjon/" class="dd-item">
                            <a href="/docs/guides/integrasjon/tjenesteeiere/api/autorisasjon/"><span>Autorisasjon</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/integrasjon/tjenesteeiere/api/kontaktinformasjon/" class="dd-item">
                            <a href="/docs/guides/integrasjon/tjenesteeiere/api/kontaktinformasjon/"><span>Kontaktinformasjon</span></a>
                          </li>
                        </ul>
                      </li>

                      <li data-nav-id="/docs/guides/integrasjon/tjenesteeiere/webservice/" class="dd-item">
                        <a href="/docs/guides/integrasjon/tjenesteeiere/webservice/"><span>Web Service</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                        <ul>
                          <li data-nav-id="/docs/guides/integrasjon/tjenesteeiere/webservice/feilhandtering/" class="dd-item">
                            <a href="/docs/guides/integrasjon/tjenesteeiere/webservice/feilhandtering/"><span>Feilhåndtering</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/integrasjon/tjenesteeiere/webservice/feilkoder/" class="dd-item">
                            <a href="/docs/guides/integrasjon/tjenesteeiere/webservice/feilkoder/"><span>Feilkoder</span></a>
                          </li>
                        </ul>
                      </li>

                      <li data-nav-id="/docs/guides/integrasjon/tjenesteeiere/batch/" class="dd-item">
                        <a href="/docs/guides/integrasjon/tjenesteeiere/batch/"><span>Batch</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/integrasjon/tjenesteeiere/funksjonelle-scenario/" class="dd-item">
                        <a href="/docs/guides/integrasjon/tjenesteeiere/funksjonelle-scenario/"><span>Funksjonelle scenario</span></a>
                      </li>
                    </ul>
                  </li>

                  <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/" class="dd-item">
                    <a href="/docs/guides/integrasjon/sluttbrukere/"><span>Sluttbrukere</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                    <ul>
                      <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/" class="dd-item">
                        <a href="/docs/guides/integrasjon/sluttbrukere/api/"><span>REST API</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                        <ul>
                          <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/kom-i-gang/" class="dd-item">
                            <a href="/docs/guides/integrasjon/sluttbrukere/api/kom-i-gang/"><span>Kom i gang!</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/autentisering/" class="dd-item">
                            <a href="/docs/guides/integrasjon/sluttbrukere/api/autentisering/"><span>Autentisering</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                            <ul>
                              <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/autentisering/brukernavn-og-passord/" class="dd-item">
                                <a href="/docs/guides/integrasjon/sluttbrukere/api/autentisering/brukernavn-og-passord/"><span>Brukernavn og passord</span></a>
                              </li>

                              <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/autentisering/id-porten/" class="dd-item">
                                <a href="/docs/guides/integrasjon/sluttbrukere/api/autentisering/id-porten/"><span>ID-porten</span></a>
                              </li>

                              <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/autentisering/virksomhetssertifikat/" class="dd-item">
                                <a href="/docs/guides/integrasjon/sluttbrukere/api/autentisering/virksomhetssertifikat/"><span>Virksomhets­sertifikat</span></a>
                              </li>
                            </ul>
                          </li>

                          <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/autorisasjon/" class="dd-item">
                            <a href="/docs/guides/integrasjon/sluttbrukere/api/autorisasjon/"><span>Autorisasjon</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                            <ul>
                              <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/autorisasjon/roller-og-rettigheter/" class="dd-item">
                                <a href="/docs/guides/integrasjon/sluttbrukere/api/autorisasjon/roller-og-rettigheter/"><span>Roller og rettigheter</span></a>
                              </li>

                              <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/autorisasjon/rolledefinisjoner/" class="dd-item">
                                <a href="/docs/guides/integrasjon/sluttbrukere/api/autorisasjon/rolledefinisjoner/"><span>Rolle­definisjoner</span></a>
                              </li>
                            </ul>
                          </li>

                          <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/innsyn/" class="dd-item">
                            <a href="/docs/guides/integrasjon/sluttbrukere/api/innsyn/"><span>Innsyns­tjenester</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/meldinger/" class="dd-item">
                            <a href="/docs/guides/integrasjon/sluttbrukere/api/meldinger/"><span>Meldingsboks</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                            <ul>
                              <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/meldinger/hente/" class="dd-item">
                                <a href="/docs/guides/integrasjon/sluttbrukere/api/meldinger/hente/"><span>Hente</span></a>
                              </li>

                              <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/meldinger/oppdatere/" class="dd-item">
                                <a href="/docs/guides/integrasjon/sluttbrukere/api/meldinger/oppdatere/"><span>Oppdatere</span></a>
                              </li>

                              <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/meldinger/sende-inn/" class="dd-item">
                                <a href="/docs/guides/integrasjon/sluttbrukere/api/meldinger/sende-inn/"><span>Sende inn</span></a>
                              </li>

                              <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/meldinger/signere/" class="dd-item">
                                <a href="/docs/guides/integrasjon/sluttbrukere/api/meldinger/signere/"><span>Signere</span></a>
                              </li>

                              <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/meldinger/slette/" class="dd-item">
                                <a href="/docs/guides/integrasjon/sluttbrukere/api/meldinger/slette/"><span>Slette</span></a>
                              </li>
                            </ul>
                          </li>

                          <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/diverse/" class="dd-item">
                            <a href="/docs/guides/integrasjon/sluttbrukere/api/diverse/"><span>Diverse</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                            <ul>
                              <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/diverse/profil/" class="dd-item">
                                <a href="/docs/guides/integrasjon/sluttbrukere/api/diverse/profil/"><span>Profil</span></a>
                              </li>

                              <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/diverse/metadata/" class="dd-item">
                                <a href="/docs/guides/integrasjon/sluttbrukere/api/diverse/metadata/"><span>Metadata</span></a>
                              </li>

                              <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/diverse/samtykke/" class="dd-item">
                                <a href="/docs/guides/integrasjon/sluttbrukere/api/diverse/samtykke/"><span>Samtykke</span></a>
                              </li>

                              <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/diverse/formidling/" class="dd-item">
                                <a href="/docs/guides/integrasjon/sluttbrukere/api/diverse/formidling/"><span>Formidling</span></a>
                              </li>

                              <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/diverse/betaling/" class="dd-item">
                                <a href="/docs/guides/integrasjon/sluttbrukere/api/diverse/betaling/"><span>Betaling</span></a>
                              </li>

                              <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/api/diverse/referanse-app/" class="dd-item">
                                <a href="/docs/guides/integrasjon/sluttbrukere/api/diverse/referanse-app/"><span>Referanse-app</span></a>
                              </li>
                            </ul>
                          </li>
                        </ul>
                      </li>

                      <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/webservice/" class="dd-item">
                        <a href="/docs/guides/integrasjon/sluttbrukere/webservice/"><span>Web Service</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                        <ul>
                          <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/webservice/grensesnitt/" class="dd-item">
                            <a href="/docs/guides/integrasjon/sluttbrukere/webservice/grensesnitt/"><span>Grensesnitt</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/webservice/endepunkter-oversikt/" class="dd-item">
                            <a href="/docs/guides/integrasjon/sluttbrukere/webservice/endepunkter-oversikt/"><span>Endepunkter</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/webservice/funksjonelle-scenario/" class="dd-item">
                            <a href="/docs/guides/integrasjon/sluttbrukere/webservice/funksjonelle-scenario/"><span>Funksjonelle scenario</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/webservice/hvordan-komme-i-gang/" class="dd-item">
                            <a href="/docs/guides/integrasjon/sluttbrukere/webservice/hvordan-komme-i-gang/"><span>Hvordan komme i gang</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/webservice/roller-og-rettigheter/" class="dd-item">
                            <a href="/docs/guides/integrasjon/sluttbrukere/webservice/roller-og-rettigheter/"><span>Roller og rettigheter</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/webservice/skjemasett-sammenlikning/" class="dd-item">
                            <a href="/docs/guides/integrasjon/sluttbrukere/webservice/skjemasett-sammenlikning/"><span>Skjemasett sammenligning</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/integrasjon/sluttbrukere/webservice/teknisk-implementasjon/" class="dd-item">
                            <a href="/docs/guides/integrasjon/sluttbrukere/webservice/teknisk-implementasjon/"><span>Teknisk implementasjon</span></a>
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>

              <li data-nav-id="/docs/guides/tul/" class="dd-item parent">
                <a href="/docs/guides/tul/"><span>TUL</span> <i class="fa fa-angle-down fa-lg category-icon"></i></a>
                <ul>
                  <li data-nav-id="/docs/guides/tul/innledning/" class="dd-item">
                    <a href="/docs/guides/tul/innledning/"><span>Innledning</span></a>
                  </li>

                  <li data-nav-id="/docs/guides/tul/kom-i-gang/" class="dd-item">
                    <a href="/docs/guides/tul/kom-i-gang/"><span>Kom i gang</span></a>
                  </li>

                  <li data-nav-id="/docs/guides/tul/tjenestetyper/" class="dd-item">
                    <a href="/docs/guides/tul/tjenestetyper/"><span>Tjenestetyper</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                    <ul>
                      <li data-nav-id="/docs/guides/tul/tjenestetyper/ny/" class="dd-item">
                        <a href="/docs/guides/tul/tjenestetyper/ny/"><span>Ny tjeneste og utgave</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/tul/tjenestetyper/felles-funksjonalitet/" class="dd-item">
                        <a href="/docs/guides/tul/tjenestetyper/felles-funksjonalitet/"><span>Felles</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/tul/tjenestetyper/formidling/" class="dd-item">
                        <a href="/docs/guides/tul/tjenestetyper/formidling/"><span>Formidling</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/tul/tjenestetyper/innsending/" class="dd-item">
                        <a href="/docs/guides/tul/tjenestetyper/innsending/"><span>Innsending</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                        <ul>
                          <li data-nav-id="/docs/guides/tul/tjenestetyper/innsending/betaling/" class="dd-item">
                            <a href="/docs/guides/tul/tjenestetyper/innsending/betaling/"><span>Betaling</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/tul/tjenestetyper/innsending/master/" class="dd-item">
                            <a href="/docs/guides/tul/tjenestetyper/innsending/master/"><span>Master</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/tul/tjenestetyper/innsending/vedleggstyper/" class="dd-item">
                            <a href="/docs/guides/tul/tjenestetyper/innsending/vedleggstyper/"><span>Vedleggstyper</span></a>
                          </li>
                        </ul>
                      </li>

                      <li data-nav-id="/docs/guides/tul/tjenestetyper/innsyn/" class="dd-item">
                        <a href="/docs/guides/tul/tjenestetyper/innsyn/"><span>Innsyn</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/tul/tjenestetyper/lenke/" class="dd-item">
                        <a href="/docs/guides/tul/tjenestetyper/lenke/"><span>Lenke</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/tul/tjenestetyper/melding/" class="dd-item">
                        <a href="/docs/guides/tul/tjenestetyper/melding/"><span>Melding</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/tul/tjenestetyper/samhandling/" class="dd-item">
                        <a href="/docs/guides/tul/tjenestetyper/samhandling/"><span>Samhandling</span></a>
                      </li>
                    </ul>
                  </li>

                  <li data-nav-id="/docs/guides/tul/funksjonalitet/" class="dd-item">
                    <a href="/docs/guides/tul/funksjonalitet/"><span>Funksjonalitet</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                    <ul>
                      <li data-nav-id="/docs/guides/tul/funksjonalitet/kodelister/" class="dd-item">
                        <a href="/docs/guides/tul/funksjonalitet/kodelister/"><span>Kodelister</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/tul/funksjonalitet/migrering/" class="dd-item">
                        <a href="/docs/guides/tul/funksjonalitet/migrering/"><span>Migrering</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/tul/funksjonalitet/oversetting/" class="dd-item">
                        <a href="/docs/guides/tul/funksjonalitet/oversetting/"><span>Oversetting</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/tul/funksjonalitet/rolleadministrasjon/" class="dd-item">
                        <a href="/docs/guides/tul/funksjonalitet/rolleadministrasjon/"><span>Rolleadministrasjon</span></a>
                      </li>
                    </ul>
                  </li>

                  <li data-nav-id="/docs/guides/tul/diverse/" class="dd-item">
                    <a href="/docs/guides/tul/diverse/"><span>Diverse</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                    <ul>
                      <li data-nav-id="/docs/guides/tul/diverse/administrators-oppgaver/" class="dd-item">
                        <a href="/docs/guides/tul/diverse/administrators-oppgaver/"><span>Administrators oppgaver</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/tul/diverse/begrepsliste/" class="dd-item">
                        <a href="/docs/guides/tul/diverse/begrepsliste/"><span>Begrepsliste</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/tul/diverse/ekstern-stil/" class="dd-item">
                        <a href="/docs/guides/tul/diverse/ekstern-stil/"><span>Ekstern stil</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/tul/diverse/enhetstest/" class="dd-item">
                        <a href="/docs/guides/tul/diverse/enhetstest/"><span>Enhetstest</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/tul/diverse/sletting/" class="dd-item">
                        <a href="/docs/guides/tul/diverse/sletting/"><span>Slette tjeneste og utgave</span></a>
                      </li>
                    </ul>
                  </li>

                  <li data-nav-id="/docs/guides/tul/vedlegg/" class="dd-item parent">
                    <a href="/docs/guides/tul/vedlegg/"><span>Vedlegg</span> <i class="fa fa-angle-down fa-lg category-icon"></i></a>
                    <ul>
                      <li data-nav-id="/docs/guides/tul/vedlegg/a/" class="dd-item">
                        <a href="/docs/guides/tul/vedlegg/a/"><span>A: Skjemautvikling i InfoPath</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/tul/vedlegg/b/" class="dd-item">
                        <a href="/docs/guides/tul/vedlegg/b/"><span>B: Utforming av brukergrensesnitt for skjema</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/tul/vedlegg/c/" class="dd-item">
                        <a href="/docs/guides/tul/vedlegg/c/"><span>C: Utforming av brukervennlige tjenester</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/tul/vedlegg/d/" class="dd-item">
                        <a href="/docs/guides/tul/vedlegg/d/"><span>D: InfoPath kodestandard</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/tul/vedlegg/e/" class="dd-item">
                        <a href="/docs/guides/tul/vedlegg/e/"><span>E: InfoPath navnestandard</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/tul/vedlegg/f/" class="dd-item">
                        <a href="/docs/guides/tul/vedlegg/f/"><span>F: Bruk av Visual Studio</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/tul/vedlegg/g/" class="dd-item">
                        <a href="/docs/guides/tul/vedlegg/g/"><span>G: Web Service-oppslag fra InfoPath</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/tul/vedlegg/mappere/" class="dd-item parent">
                        <a href="/docs/guides/tul/vedlegg/mappere/"><span>Mappere</span> <i class="fa fa-angle-down fa-lg category-icon"></i></a>
                        <ul>
                          <li data-nav-id="/docs/guides/tul/vedlegg/mappere/generelt/" class="dd-item">
                            <a href="/docs/guides/tul/vedlegg/mappere/generelt/"><span>Generelt</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/tul/vedlegg/mappere/teknologi/" class="dd-item">
                            <a href="/docs/guides/tul/vedlegg/mappere/teknologi/"><span>Teknologi</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/tul/vedlegg/mappere/utvikling/" class="dd-item parent active">
                            <a href="/docs/guides/tul/vedlegg/mappere/utvikling/"><span>Utvikling</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/tul/vedlegg/mappere/testing/" class="dd-item">
                            <a href="/docs/guides/tul/vedlegg/mappere/testing/"><span>Testing</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/tul/vedlegg/mappere/installasjon/" class="dd-item">
                            <a href="/docs/guides/tul/vedlegg/mappere/installasjon/"><span>Installasjon</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/tul/vedlegg/mappere/diverse/" class="dd-item">
                            <a href="/docs/guides/tul/vedlegg/mappere/diverse/"><span>Diverse</span></a>
                          </li>
                        </ul>
                      </li>

                      <li data-nav-id="/docs/guides/tul/vedlegg/regelmotor/" class="dd-item">
                        <a href="/docs/guides/tul/vedlegg/regelmotor/"><span>Regelmotor</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                        <ul>
                          <li data-nav-id="/docs/guides/tul/vedlegg/regelmotor/innledning/" class="dd-item">
                            <a href="/docs/guides/tul/vedlegg/regelmotor/innledning/"><span>Innledning</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/tul/vedlegg/regelmotor/regler/" class="dd-item">
                            <a href="/docs/guides/tul/vedlegg/regelmotor/regler/"><span>Regler</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/tul/vedlegg/regelmotor/betingelser/" class="dd-item">
                            <a href="/docs/guides/tul/vedlegg/regelmotor/betingelser/"><span>Betingelser</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/tul/vedlegg/regelmotor/utvidede-beskrivelser/" class="dd-item">
                            <a href="/docs/guides/tul/vedlegg/regelmotor/utvidede-beskrivelser/"><span>Utvidede beskrivelser</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/tul/vedlegg/regelmotor/eksempler/" class="dd-item">
                            <a href="/docs/guides/tul/vedlegg/regelmotor/eksempler/"><span>Eksempler</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/tul/vedlegg/regelmotor/innf%C3%B8ring-i-xml/" class="dd-item">
                            <a href="/docs/guides/tul/vedlegg/regelmotor/innf%C3%B8ring-i-xml/"><span>Innføring i xml</span></a>
                          </li>

                          <li data-nav-id="/docs/guides/tul/vedlegg/regelmotor/xsd/" class="dd-item">
                            <a href="/docs/guides/tul/vedlegg/regelmotor/xsd/"><span>Regelmotor.xsd</span></a>
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>

              <li data-nav-id="/docs/guides/samtykke/" class="dd-item">
                <a href="/docs/guides/samtykke/"><span>Samtykke</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                <ul>
                  <li data-nav-id="/docs/guides/samtykke/sluttbruker/" class="dd-item">
                    <a href="/docs/guides/samtykke/sluttbruker/"><span>For sluttbruker</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                    <ul>
                      <li data-nav-id="/docs/guides/samtykke/sluttbruker/innlogging/" class="dd-item">
                        <a href="/docs/guides/samtykke/sluttbruker/innlogging/"><span>Innlogging</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/samtykke/sluttbruker/samtykkesiden/" class="dd-item">
                        <a href="/docs/guides/samtykke/sluttbruker/samtykkesiden/"><span>Samtykkesiden</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/samtykke/sluttbruker/oversikt-samtykker/" class="dd-item">
                        <a href="/docs/guides/samtykke/sluttbruker/oversikt-samtykker/"><span>Oversikt samtykker</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/samtykke/sluttbruker/trekke-samtykke/" class="dd-item">
                        <a href="/docs/guides/samtykke/sluttbruker/trekke-samtykke/"><span>Trekke samtykke</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/samtykke/sluttbruker/aktivitetslogg/" class="dd-item">
                        <a href="/docs/guides/samtykke/sluttbruker/aktivitetslogg/"><span>Aktivitetslogg</span></a>
                      </li>
                    </ul>
                  </li>

                  <li data-nav-id="/docs/guides/samtykke/datakilde/" class="dd-item">
                    <a href="/docs/guides/samtykke/datakilde/"><span>For datakilde</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                    <ul>
                      <li data-nav-id="/docs/guides/samtykke/datakilde/opprett-tjeneste/" class="dd-item">
                        <a href="/docs/guides/samtykke/datakilde/opprett-tjeneste/"><span>Opprette tjeneste</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/samtykke/datakilde/autorisere-datakonsument/" class="dd-item">
                        <a href="/docs/guides/samtykke/datakilde/autorisere-datakonsument/"><span>Autorisere datakonsument</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/samtykke/datakilde/bruk-av-token/" class="dd-item">
                        <a href="/docs/guides/samtykke/datakilde/bruk-av-token/"><span>Informasjon om token</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/samtykke/datakilde/test-tjeneste/" class="dd-item">
                        <a href="/docs/guides/samtykke/datakilde/test-tjeneste/"><span>Test av tjeneste</span></a>
                      </li>
                    </ul>
                  </li>

                  <li data-nav-id="/docs/guides/samtykke/datakonsument/" class="dd-item">
                    <a href="/docs/guides/samtykke/datakonsument/"><span>For datakonsument</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                    <ul>
                      <li data-nav-id="/docs/guides/samtykke/datakonsument/komme-i-gang/" class="dd-item">
                        <a href="/docs/guides/samtykke/datakonsument/komme-i-gang/"><span>Komme i gang</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/samtykke/datakonsument/be-om-samtykke/" class="dd-item">
                        <a href="/docs/guides/samtykke/datakonsument/be-om-samtykke/"><span>Be om samtykke</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/samtykke/datakonsument/hente-token/" class="dd-item">
                        <a href="/docs/guides/samtykke/datakonsument/hente-token/"><span>Hente token</span></a>
                      </li>

                      <li data-nav-id="/docs/guides/samtykke/datakonsument/test-tjeneste/" class="dd-item">
                        <a href="/docs/guides/samtykke/datakonsument/test-tjeneste/"><span>Test av samtykke</span></a>
                      </li>
                    </ul>
                  </li>

                  <li data-nav-id="/docs/guides/samtykke/begrepsliste/" class="dd-item">
                    <a href="/docs/guides/samtykke/begrepsliste/"><span>Begrepsliste</span></a>
                  </li>
                </ul>
              </li>

              <li data-nav-id="/docs/guides/digital-post-til-virksomheter/" class="dd-item">
                <a href="/docs/guides/digital-post-til-virksomheter/"><span>Digital Post til Virksomheter</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                <ul>
                  <li data-nav-id="/docs/guides/digital-post-til-virksomheter/sp%C3%B8rsm%C3%A5l-og-svar/" class="dd-item">
                    <a href="/docs/guides/digital-post-til-virksomheter/sp%C3%B8rsm%C3%A5l-og-svar/"><span>Spørsmål og svar om DPV</span></a>
                  </li>
                </ul>
              </li>

              <li data-nav-id="/docs/guides/autorisasjon/" class="dd-item">
                <a href="/docs/guides/autorisasjon/"><span>Autorisasjon</span></a>
              </li>
            </ul>
          </li>

          <li data-nav-id="/docs/altinncore/" class="dd-item">
            <a href="/docs/altinncore/"><span>Tjenester 3.0</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
            <ul>
              <li data-nav-id="/docs/altinncore/goals/" class="dd-item">
                <a href="/docs/altinncore/goals/"><span>Målsettinger</span></a>
              </li>

              <li data-nav-id="/docs/altinncore/status/" class="dd-item">
                <a href="/docs/altinncore/status/"><span>Status</span></a>
              </li>

              <li data-nav-id="/docs/altinncore/satsingsforslag/" class="dd-item">
                <a href="/docs/altinncore/satsingsforslag/"><span>Satsingsforslag 2018</span></a>
              </li>

              <li data-nav-id="/docs/altinncore/architecture/" class="dd-item">
                <a href="/docs/altinncore/architecture/"><span>Arkitektur</span></a>
              </li>

              <li data-nav-id="/docs/altinncore/faq/" class="dd-item">
                <a href="/docs/altinncore/faq/"><span>FAQ</span></a>
              </li>

              <li data-nav-id="/docs/altinncore/slide/" class="dd-item">
                <a href="/docs/altinncore/slide/"><span>Slide</span></a>
              </li>
            </ul>
          </li>

          <li data-nav-id="/docs/releases/" class="dd-item">
            <a href="/docs/releases/"><span>Endringslogg</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
            <ul>
              <li data-nav-id="/docs/releases/2017/" class="dd-item">
                <a href="/docs/releases/2017/"><span>2017</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                <ul>
                  <li data-nav-id="/docs/releases/2017/17-3/" class="dd-item">
                    <a href="/docs/releases/2017/17-3/"><span>17.3</span></a>
                  </li>

                  <li data-nav-id="/docs/releases/2017/17-2/" class="dd-item">
                    <a href="/docs/releases/2017/17-2/"><span>17.2</span></a>
                  </li>

                  <li data-nav-id="/docs/releases/2017/17-1-1/" class="dd-item">
                    <a href="/docs/releases/2017/17-1-1/"><span>17.1.1</span></a>
                  </li>

                  <li data-nav-id="/docs/releases/2017/etablering/" class="dd-item">
                    <a href="/docs/releases/2017/etablering/"><span>Etablering</span></a>
                  </li>

                  <li data-nav-id="/docs/releases/2017/17-1/" class="dd-item">
                    <a href="/docs/releases/2017/17-1/"><span>17.1</span></a>
                  </li>
                </ul>
              </li>

              <li data-nav-id="/docs/releases/2016/" class="dd-item">
                <a href="/docs/releases/2016/"><span>2016</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                <ul>
                  <li data-nav-id="/docs/releases/2016/16-1/" class="dd-item">
                    <a href="/docs/releases/2016/16-1/"><span>16.1</span></a>
                  </li>
                </ul>
              </li>

              <li data-nav-id="/docs/releases/2015/" class="dd-item">
                <a href="/docs/releases/2015/"><span>2015</span> <i class="fa fa-angle-right fa-lg category-icon"></i></a>
                <ul>
                  <li data-nav-id="/docs/releases/2015/15-3/" class="dd-item">
                    <a href="/docs/releases/2015/15-3/"><span>15.3</span></a>
                  </li>

                  <li data-nav-id="/docs/releases/2015/15-2/" class="dd-item">
                    <a href="/docs/releases/2015/15-2/"><span>15.2</span></a>
                  </li>

                  <li data-nav-id="/docs/releases/2015/15-1/" class="dd-item">
                    <a href="/docs/releases/2015/15-1/"><span>15.1</span></a>
                  </li>
                </ul>
              </li>
            </ul>
          </li>

          <li class="" role="">
            <h3>
              Lenker
            </h3>
            <a href="https://altinn.github.io/DesignSystem"><i class='fa fa-fw fa-star'></i> Designsystem</a>
          </li>

          <li class="" role="">
            <a href="https://altinnett.brreg.no/"><i class='fa fa-fw fa-info-circle'></i> Altinnett</a>
          </li>

          <li class="" role="">
            <a href="/docs/credits"><i class='fa fa-fw fa-bullhorn'></i> Kred</a>
          </li>

          <li class="" role="">
            <a href="https://github.com/altinn/docs"><i class='fa fa-fw fa-github'></i> GitHub</a>
          </li>
        </ul>

        <section id="footer">
        </section>
      </div>
    </nav>

    <section id="body">
      <div id="overlay">
      </div>

      <div class="padding highlightable">
        <div id="top-bar">
          <div id="top-github-link">
            <a class="github-link" href="https://github.com/altinn/docs/blob/master/content/guides/tul/vedlegg/mappere/utvikling/_index.md" target="blank"><i class="fa fa-code-fork"></i> Endre</a>
          </div>

          <div id="breadcrumbs" itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
            <span id="sidebar-toggle-span"><a href="#" id="sidebar-toggle" data-sidebar-toggle=""><i class="fa fa-bars"></i></a></span> <span id="toc-menu"><i class="fa fa-list-alt"></i></span> <span class="links"><a href='/docs/'>Altinn docs</a> / <a href='/docs/guides/'>Guider</a> / <a href='/docs/guides/tul/'>TUL</a> / <a href='/docs/guides/tul/vedlegg/'>Vedlegg</a> / <a href='/docs/guides/tul/vedlegg/mappere/'>Mappere</a> / Utvikling</span>
          </div>

          <div class="progress">
            <div class="wrapper">
              <nav id="TableOfContents">
                <ul>
                  <li>
                    <ul>
                      <li>
                        <a href="#hente-kildekode">Hente kildekode</a>
                      </li>

                      <li>
                        <a href="#definere-service-contract">Definere Service Contract</a>
                      </li>

                      <li>
                        <a href="#eksempel-fra-testdepartementet">Eksempel fra Testdepartementet</a>
                      </li>

                      <li>
                        <a href="#definere-datakontrakter">Definere datakontrakter</a>
                      </li>

                      <li>
                        <a href="#eksempel-fra-testdepartementet-1">Eksempel fra Testdepartementet</a>
                      </li>

                      <li>
                        <a href="#koble-til-etat-systemet">Koble til etat-systemet</a>
                      </li>

                      <li>
                        <a href="#datakonvertering">Datakonvertering</a>
                      </li>

                      <li>
                        <a href="#implementere-mappertjenesten">Implementere mappertjenesten</a>
                      </li>

                      <li>
                        <a href="#logging">Logging</a>
                      </li>

                      <li>
                        <a href="#rammeverk-for-fellesfunksjonalitet">Rammeverk for fellesfunksjonalitet</a>
                      </li>

                      <li>
                        <a href="#konfigurasjonsparametere">Konfigurasjonsparametere</a>
                      </li>

                      <li>
                        <a href="#versjonskontroll">Versjonskontroll</a>
                        <ul>
                          <li>
                            <a href="#sjekke-inn-kode">Sjekke inn kode</a>
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
              </nav>
            </div>
          </div>
        </div>

        <div id="body-inner">
          <h1>
            Utvikling
          </h1>

          <p>
            En mapper utvikles i prosjektet Services. Dette er et .NET 3.5 prosjekt som inneholder en WCF-tjeneste med tilhørende tjeneste- og datakontrakt. I tillegg er det noen støtteklasser som kan benyttes. Strukturen i prosjektet er vist under.
          </p>

          <figure>
            <img src="project-structure-vs.png?width=400" alt="Visual Studio-prosjekt">
          </figure>

          <h2 id="hente-kildekode">
            Hente kildekode
          </h2>

          <p>
            Altinn benytter Team Foundation Server til versjonskontroll. De nødvendige verktøyene for å kunne sjekke inn og ut kode er tilgjengelig direkte i Visual Studio. For å sjekke inn eller ut kode kan dette gjøres ved å høyreklikke på solution eller prosjektet og velge ulike handlinger der.
          </p>

          <p>
            Hvordan man skal koble seg til Altinn sin Team Foundation Server er beskrevet <a href="../../f/#koble-opp-mot-tjenesteeiers-tfs-prosjekt">her</a>.
          </p>

          <figure>
            <img src="get-source-code.png" alt="Hente kildekode">
          </figure>

          <p>
            Når man har fått sjekket ut koden vil Visual Studio sin Source Control Explorer se ut slik som på bildet over. Her kan man navigere rundt i kildekoden og se på filene eller jobbe videre med de lokalt. Her ser man Testdepartementet og felleskomponentene i Common. Tjenesteeier sitt område vil også vises her. For å åpne mapperen til testdepartementet navigerer man inn til Foererkort-mappen som vist her og åpner Altinn.TTD.Foererkort.Mapper.sln. Dette vil åpne mapper-solutionen i Visual Studio.
          </p>

          <p>
            Mapperene er organisert i et hierarki med de ulike tjenesteeierene som toppnoder. Innenfor hver tjenesteeier kan det være ulike funksjonsområder med en dedikert mapper. I testdepartementet TTD er funksjonområdet Førerkort realisert med en mapper som på bildet over.
          </p>

          <h2 id="definere-service-contract">
            Definere Service Contract
          </h2>

          <p>
            Det første man gjør når man skal utvikle en mapper er å definere tjenestekontrakten for mapperen. Dette gjøres ved å opprette en Service Contract i filen <code>IMapper.cs</code>. Dette er et interface som beskriver hvilke operasjoner som skal være tilgjengelig på tjenesten. For å angi at interfacet er en WCF-tjenestekontrakt må ServiceContract-attributtet angis. Her må også mapperen sitt namespace angis.
          </p>

          <p>
            Alle operasjonene som skal være tilgjengelig på tjenestekontrakten opprettes som metoder i interfacet og markeres med attributtet OperationContract. Alle operasjoner må ta inn et forespørsel-objekt og returnere et respons-objekt. Disse objektene må navngis med «Forespoersel» og «Respons» postfiks.
          </p>

          <h2 id="eksempel-fra-testdepartementet">
            Eksempel fra Testdepartementet
          </h2>

          <p>
            Under er det vist et eksempel på en slik tjenestekontrakt. Her defineres «GetMidlertidigKjoeretillatelse». Denne tjenesten tar inn et forespørsel-objekt og returnerer et respons-objekt.
          </p>

          <p>
            Eksempelkoden for testdepartementet finnes i TFS på stien <code>$/TTD/Mappers/Foererkort/</code>.
          </p>

          <p>
            Eksempel på tjenestekontrakt:
          </p>

          <pre><code class="language-csharp">using System.ServiceModel;

namespace Altinn.SBL.ServiceEngine.LookUp.Mappers.TTD.Services
{
    [ServiceContract(Namespace = "http://www.altinn.no/mapperservices/ttd/2011/06")]
    public interface IMapper
    {
        [OperationContract]        
        TillatelseRespons GetMidlertidigKjoeretillatelse(
            TillatelseForespoersel forespoersel); 
    }
}
</code></pre>
          <h2 id="definere-datakontrakter">
            Definere datakontrakter
          </h2>

          <p>
            All informasjon som skal overføres med WCF-tjenester må angis med datakontrakter. Dette er vanlige kodeklasser som markeres med DataContract-attributter. Klassene skal ligge i filen <code>Transfer.cs</code>. Variabler med DataMember-attributter angir data som skal overføres. Det er fullt mulig å angi komplekse datastrukturer ved å opprette hierarkiske datakontrakter. Forespørsler skal navngis med Forespoersel-postfiks og Respons-objekter med Respons-postfiks, og det er en begrensning på maks 2MB overført data per kall.
          </p>

          <h2 id="eksempel-fra-testdepartementet-1">
            Eksempel fra Testdepartementet
          </h2>

          <p>
            Testdepartementet sin tjeneste mottar et TillatelseForespoersel-objekt som angir fødselsnummeret for den brukeren som skal hamidlertidig kjøretillatelse.
          </p>

          <pre><code class="language-csharp">using System.Runtime.Serialization;

namespace Altinn.SBL.ServiceEngine.LookUp.Mappers.TTD.Services
{
    [DataContract]
    public class TillatelseForespoersel
    {
        [DataMember]
        public string Fnr;
    }
}
</code></pre>
          <p>
            Når forespørselen om midlertidig kjøretillatelse er behandlet returneres det et respons-objekt som vist under. Dette inneholder et tillatelse-objekt og en tekststreng som viser statusen på tillatelsen. Tillatelse-objektet inneholder igjen en Adresse. På denne måten kan dataene struktureres på en intuitiv måte slik at skjemautviklerene lett kan presentere informasjonen.
          </p>

          <pre><code class="language-csharp">using System.Runtime.Serialization;

namespace Altinn.SBL.ServiceEngine.LookUp.Mappers.TTD.Services
{
    [DataContract]
    public class TillatelseRespons
    {
        [DataMember] public Tillatelse Tillatelse;
        [DataMember] public string Status;
    }

    [DataContract]
    public class Tillatelse
    {
        [DataMember] public string Fnr;
        [DataMember] public string Navn;
        [DataMember] public string Godkjent;
        [DataMember] public string Utloper;
        [DataMember] public Adresse Adresse;
        [DataMember] public string Klasser;
    }

    [DataContract]
    public class Adresse
    {
        [DataMember] public string Lokasjon;
        [DataMember] public int Postnummer;
        [DataMember] public string Poststed;
        [DataMember] public string AnnenAddresse;
    }
}
</code></pre>
          <h2 id="koble-til-etat-systemet">
            Koble til etat-systemet
          </h2>

          <p>
            Når man skal koble seg til et etatsystem fra en mapper må denne ha en tjenestereferanse til den tjenesten som skal benyttes. Referansen settes opp ved å <a href="../teknologi/#service-reference">følge oppskriften</a>. Adressen avhenger av etatsystemet men kan for eksempel se slik ut:
          </p>

          <p>
            <a href="https://altetat.brreg.no/ttd-war/PortalServices">https://altetat.brreg.no/ttd-war/PortalServices</a>
          </p>

          <p>
            Når man kobler seg til etatsystemet vil Visual Studio oppdatere app.config med en del konfigurasjon. Denne konfigurasjonen må også legges til i de konfigurasjonsfilene som installeres på Altinn sine servere.
          </p>

          <h2 id="datakonvertering">
            Datakonvertering
          </h2>

          <p>
            En mapper er i sin enkleste form tilgjengeliggjøring av en etat-tjeneste som en tjeneste i Altinn. For at informasjon skal kunne flyte gjennom mappere må det derfor konverteres mellom mapperens og etatsystemenes datakontrakter.
          </p>

          <p>
            Konverteringen må settes opp fordi det ikke er ønskelig at tjenesteeier sine datakontrakter benyttes som datakontrakter for mapperen. Ved å separere kontraktene på denne måten sikrer man at endringer i tjenesteeier sine kontrakter ikke påvirker mapperene sine kontrakter og dermed også skjemaene i Altinn.
          </p>

          <p>
            Det andre aspektet er at det å benytte etatens kontrakter som mapperenes kontrakter er uheldig og komplisert. Noen etatsystem tilgjengeliggjør sine tjenester med svakt typet data. Dette er i noen tilfeller nødvendig på grunn av etatsystemets funksjonalitet eller tekniske begrensninger eller krav. Dette er noe som bør unngås dersom det ikke er spesielle årsaker for siden det da kan komplisere utvikling og testing av mapperen.
          </p>

          <p>
            Konverteringen gjøres i filen Utility.cs. Her må det implementeres en klasse som heter <code>Converter</code>. Denne klassen inneholder et sett med convert-metoder som konverterer mellom de ulike datakontraktene.
          </p>

          <pre><code class="language-csharp">using System;
using System.Text;

namespace Altinn.SBL.ServiceEngine.LookUp.Mappers.TTD.Services
{
    internal class Converter
    {
        public static Tillatelse Convert(tillatelseVO vo)
        {
            if (vo != null)
                return new Tillatelse()
                {
                    Fnr = vo.fnr,
                    Navn = vo.navn,
                    Godkjent = vo.godkjent,
                    Utloper = vo.utloeper,
                    Adresse = Convert(vo.adresseVO),
                    Klasser = Convert(vo.korttyper)
                };
            else return null;
        }

        public static Adresse Convert(adresseVO vo)
        {
            if (vo != null)
                return new Adresse()
                {
                    Lokasjon = vo.lokasjon,
                    Postnummer = vo.postnummer,
                    AnnenAddresse = vo.annenAdresse,
                    Poststed = vo.poststed
                };
            else return null;
        }
    }
}
</code></pre>
          <h2 id="implementere-mappertjenesten">
            Implementere mappertjenesten
          </h2>

          <p>
            Selve implementasjonen av mappere gjøres i Mapper.cs. Her er klassen Mapper som implementerer tjenestekontrakten <code>IMapper</code>. Eksempelet under viser en enkel implementasjon av en mapper. Her er blant annet logging utelatt.
          </p>

          <pre><code class="language-csharp">using System;
using System.ServiceModel;
using Altinn.SBL.ServiceEngine.LookUp.Mappers.TTD.Services.SvcRef;
using System.Configuration;
using System.Net;

namespace Altinn.SBL.ServiceEngine.LookUp.Mappers.TTD.Services
{
    [ServiceBehavior(InstanceContextMode = InstanceContextMode.PerCall, 
        Namespace = "http://www.altinn.no/mapperservice/ttd/2011/06")]
    public class Mapper : IMapper
    {        
        public TillatelseRespons GetMidlertidigKjoeretillatelse(
            TillatelseForespoersel forespoersel) 
        {
            var respons = new TillatelseRespons();
            using (var proxy = new PortalServicesClient())
            {
                try
                {
                    var vo = proxy.getMidlertidigKjoeretillatelse(forespoersel.Fnr);
                    respons.Tillatelse = Converter.Convert(vo);
                    respons.Status = "OK";
                }
                catch (Exception ex)
                {
                    respons.Status = "Web Service call failed, " + 
                        "please contact administrator";
                }
            }
            return respons;
        }
    }
</code></pre>
          <p>
            Over er det brukt noen syntaks-elementer som er særegent for .NET. Dette er typen <code>var</code> og block-statementet <code>using</code>.
          </p>

          <p>
            Typen <code>var</code> er en uspesifisert variabeltype som kompilatoren bytter ut med korrekt type under kompilering. Under er det vist to kodelinjer som resulterer i samme kompilerte kode. Linje nummer to benytter var-typen. Som det vises av eksempelet gjør var at utvikleren ikke trenger å spesifisere type-informasjonen to ganger. Var er altså kun syntaktisk sukker som gjør utviklingen enklere.
          </p>

          <pre><code class="language-csharp">// Eksplisitt angitt type
TillatelseRespons respons = new TillatelseRespons();

// Bruk av var.
var respons = new TillatelseRespons();
</code></pre>
          <p>
            Blockstatementen using benyttes for å sikre at begrensede ressurser frigis etter bruk. Dette er også kun syntaktisk sukker som sikrer at Dispose-metoden blir kalt etter at en ressurs er benyttet. To ekvivalente eksempler er vist under.
          </p>

          <pre><code class="language-csharp">// Eksplisitt frigjøring av begrensede ressurser.
var proxy = new PortalServicesClient();
proxy.getMidlertidigKjoeretillatelse(forespoersel.Fnr);
proxy.Dispose();

// Frigjøring av begrensede ressurser ved bruk av using.
using (var proxy = new PortalServicesClient())
{
    proxy.getMidlertidigKjoeretillatelse(forespoersel.Fnr);
}
</code></pre>
          <h2 id="logging">
            Logging
          </h2>

          <p>
            For å kunne overvåke og feilsøke mapperen under utvikling og i produksjon er det viktig at den logger viktige hendelser. Dette inkluderer tjenestekall og feilsituasjoner. Gode logger gjør det enklere å få innsikt i tilstand og ytelse, samt identifisere feilen dersom det skulle oppstå problemer.
          </p>

          <p>
            Logging gjøres ved bruk av klassen Trace som er standardfunksjonalitet i .NET-rammeverket. Her kan man spesifisere ulike typer logginnslag gjennom bruk av metodene TraceInformation, TraceWarning og TraceError. Metodene funger likt, men vil markere logginnslaget med ulik alvorlighetsgrad. Hver mapper har sin egen loggfil.
          </p>

          <p>
            For å skru på at Trace skal logges må dette konfigureres i tjenestens config-fil. Dette gjøres som vist under.
          </p>

          <pre><code class="language-xml">&lt;?xml version="1.0"?&gt;
&lt;configuration&gt;
  &lt;system.diagnostics&gt;
    &lt;trace autoflush="true"&gt;
      &lt;listeners&gt;
        &lt;add name="MapperListener"
             type="System.Diagnostics.TextWriterTraceListener"
             initializeData="Trace.csv" /&gt;
      &lt;/listeners&gt;
    &lt;/trace&gt;
  &lt;/system.diagnostics&gt;
&lt;/configuration&gt;
</code></pre>
          <p>
            Metoden TraceInformation kan brukes på ulike måter. Under er tre eksempler som bygger opp en formatert streng som viser dagens dato:
          </p>

          <pre><code class="language-csharp">var message = "Dagens dato er " + DateTime.Now.ToString();
Trace.TraceInformation(message);

var format = "Dagens dato er {0}";
Trace.TraceInformation(format,DateTime.Now);

var formattedMessage = string.Format(format, DateTime.Now)
Trace.Traceinformation(formattedMessage);
</code></pre>
          <p>
            I mappere bør man benytte standard oppsett på logginnslagene slik at det er lett å lese loggene i etterkant.
          </p>

          <p>
            Et forslag til slikt format er gitt i eksempelet. Her er det fire parametere som benyttes.
          </p>

          <ul>
            <li>Det første angir tidspunktet for logginnslaget.
            </li>

            <li>Det neste viser kilden i form av metodenavnet.
            </li>

            <li>Deretter følger type innslag og verdien.
            </li>
          </ul>

          <p>
            Når man leser loggen kan man da velge å filtrere på ulike typer kilder, innslagstyper og dato.
          </p>

          <pre><code class="language-csharp">// Her hentes informasjon om starttidspunkt og metode som kalles.
// Dette gjøres tidlig i metoden.
DateTime start = DateTime.Now;
string methodName = MethodBase.GetCurrentMethod().Name;

// Her logges en feilmelding med Trace.TraceError. 
// Det som logges er: tidspunktet, metodenavn og feilmelding.
// Dette gjøres for alle feilmeldinger som kommer i metoden.
Trace.TraceError(string.Format(";{0};{1};{2};{3}", Clock.GetTimestamp(), methodName, "Exception", ex.Message));

// Her logges en fullført tjenestekall med Trace.TraceInformation. 
// Det som logges er: tidspunkt, metodenavn og varighet
// Dette gjøres på slutten av alle tjenester
Trace.TraceInformation(string.Format(";{0};{1};{2};{3}", Clock.GetTimestamp(), methodName, "Duration", (DateTime.Now - start).TotalMilliseconds));
</code></pre>
          <p>
            I eksempelet er logging inkludert i mapperimplementasjonen. Her logger man alle tjenestekall som gjøres, samt logger alle feilmeldinger som kastes dersom etatsystemet returnerer feil.
          </p>

          <pre><code class="language-csharp">using System;
using System.ServiceModel;
using Altinn.SBL.ServiceEngine.LookUp.Mappers.TTD.Services.SvcRef;
using System.Diagnostics;
using System.Configuration;
using System.Net;
using Altinn.SBL.ServiceEngine.LookUp.Mappers.TTD.Services.SvcSecRef;

namespace Altinn.SBL.ServiceEngine.LookUp.Mappers.TTD.Services
{
    [ServiceBehavior(InstanceContextMode = InstanceContextMode.PerCall, 
        Namespace = "http://www.altinn.no/mapperservice/ttd/2011/06")]
    public class Mapper : IMapper
    {        
        public TillatelseRespons GetMidlertidigKjoeretillatelse(
            TillatelseForespoersel forespoersel) 
        {
            DateTime start = DateTime.Now;
            TillatelseRespons respons = new TillatelseRespons();
            string methodName = MethodBase.GetCurrentMethod().Name;

            using (var proxy = new PortalServicesClient())
            {
                try
                {
                    var vo = proxy.getMidlertidigKjoeretillatelse(forespoersel.Fnr);
                    respons.Tillatelse = Converter.Convert(vo);
                    respons.Status = "OK";
                }
                catch (Exception ex)
                {
                    Trace.TraceError(string.Format(";{0};{1};{2};{3}",        
                        Clock.GetTimestamp(), methodName, 
                        "Exception", ex.Message));
                    respons.Status = "Web Service call failed, " + 
                        "please contact administrator";
                    }
                }
            }
            else
            {
                respons.Status = "Context verification failed, " + 
                    "please contact administrator";
            }
            Trace.TraceInformation(string.Format(";{0};{1};{2};{3}",                
                Clock.GetTimestamp(), methodName, "Duration", 
                (DateTime.Now - start).TotalMilliseconds));
            return respons;
        }
    }    
</code></pre>
          <p>
            I eksempelet over fanges alle feilmeldinger med den generelle try-catchen for Exception. Dette vil sikre at det ikke lekker feil ut fra denne kodeblokken, men det vil samtidig skjule verdifull informasjon fra feilloggen. Det kan derfor være lurt å skille på ulike feil slik at man får et mer differensiert bilde av hva som går feil hvis det skulle inntreffe.
          </p>

          <p>
            En try-catch-sekvens fungerer slik at feilen vil fanges i den første catchen som dekker den aktuelle feilen. Rekkefølgen må derfor være fra mest til minst spesifikk. Et anbefalt minimum er sekvensen FaultException, CommunicationException, TimeoutException og til slutt Exception for å fange alle overskytende feilmeldinger.
          </p>

          <pre><code class="language-csharp">try
{
  // Utfør kall til tjensteeier sine system.
}
catch (FaultException ex)
{
  Trace.TraceError(string.Format(";{0};{1};{2};{3}",        
    Clock.GetTimestamp(), methodName, 
    "FaultException", ex.Message));
}
catch (CommunicationException ex)
{
  Trace.TraceError(string.Format(";{0};{1};{2};{3}",        
    Clock.GetTimestamp(), methodName, 
    "CommunicationException", ex.Message));
}
catch (TimeoutException ex)
{
  Trace.TraceError(string.Format(";{0};{1};{2};{3}",        
    Clock.GetTimestamp(), methodName, 
    "Exception", ex.Message));
}
catch (Exception ex)
{
  Trace.TraceError(string.Format(";{0};{1};{2};{3}",        
    Clock.GetTimestamp(), methodName, 
    "Exception", ex.Message));
}
</code></pre>
          <h2 id="rammeverk-for-fellesfunksjonalitet">
            Rammeverk for fellesfunksjonalitet
          </h2>

          <p>
            En mapper har tilgang til en del fellesfunksjonalitet. Dette er samlet i Altinn.Common.dll. Denne må legges til i Services-prosjektet som en assembly-referanse. Den samme prosessen må gjøres for to andre assemblys som Altinn.Common er avhengig av. Assemblyene ligger på følgende plassering i versjonskontrollsystemet:
          </p>

          <ul>
            <li>$/Common/&lt;siste tilgjengelige versjon&gt;/lib/Altinn.Common.dll
            </li>

            <li>$/Common/Frameworks/entlib/4.1/bin/Microsoft.Practices.EnterpriseLibrary.Common.dll
            </li>

            <li>$/Common/Frameworks/entlib/4.1/bin/Microsoft.Practices.EnterpriseLibrary.Logging.dll
            </li>
          </ul>

          <h2 id="konfigurasjonsparametere">
            Konfigurasjonsparametere
          </h2>

          <p>
            Dersom man har spesielle konfigurasjonsparametere man ikke ønsker å kode inn i en mapper, men heller tilgjengeliggjøre i konfigurasjonsfiler kan dette gjøres ved bruk av AppSettings-seksjonen i konfigurasjonsfilen. Dette er et enkelt «key-value» oppsett der man kan angi verdier som kan hentes ut basert på en oppslagsverdi i koden.
          </p>

          <pre><code class="language-xml">&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;configuration&gt;
  &lt;appSettings&gt;
    &lt;add key="MyKey" value="MyValue"/&gt;
  &lt;/appSettings&gt;
&lt;/configuration&gt;
</code></pre>
          <p>
            For å hente ut igjen slike verdier benyttes ConfigurationManager:
          </p>

          <pre><code class="language-csharp">var value = ConfigurationSettings.AppSettings["MyKey"];
</code></pre>
          <h2 id="versjonskontroll">
            Versjonskontroll
          </h2>

          <p>
            Altinn benytter som nevnt tidligere, Team Foundation Server til versjonskontroll. De nødvendige verktøyene for å kunne sjekke inn og ut kode er tilgjengelig direkte i Visual Studio. For å sjekke inn kode kan dette gjøres ved å høyreklikke på solutionen eller prosjektet og velge ulike handlinger der. For å sjekke inn kode velger man «Check In» som vist under.
          </p>

          <h3 id="sjekke-inn-kode">
            Sjekke inn kode
          </h3>

          <figure>
            <img src="check-in-code-vs.png?width=500" alt="Sjekke inn kode i Visual Studio">
          </figure>

          <p>
            Dette vil åpne «Pending Changes» visningen som viser hvilke endringer som kan sjekkes inn. Her skal man også skrive inn en kommentar til innsjekken slik at det er lettere å lese versjonshistorikken.
          </p>

          <figure>
            <img src="team-explorer-pending-changes.png?width=500" alt="Endret kode i Visual Studio">
          </figure>

          <footer class="footline">
          </footer>
        </div>
      </div>

      <div id="navigation">
        <a class="nav nav-prev" href="/docs/guides/tul/vedlegg/mappere/teknologi/" title="Teknologi"><i class="fa fa-chevron-left"></i></a> <a class="nav nav-next" href="/docs/guides/tul/vedlegg/mappere/testing/" title="Testing" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
      </div>
    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      </div>
    </div>
    <script src="/docs/js/clipboard.min.js"></script> 
    <script src="/docs/js/featherlight.min.js"></script> 
    <script src="/docs/js/html5shiv-printshiv.min.js"></script> 
    <script src="/docs/js/highlight.pack.js"></script> 
    <script>
    hljs.initHighlightingOnLoad();
    </script> 
    <script src="/docs/js/modernizr.custom.71422.js"></script> 
    <script src="/docs/js/learn.js"></script> 
    <script src="/docs/js/hugo-learn.js"></script>
    <link href="/docs/mermaid/mermaid.css" type="text/css" rel="stylesheet">
    <script src="/docs/mermaid/mermaid.js"></script> 
    <script>
    mermaid.initialize({startOnLoad:true});
    </script>
  </body>
</html>
